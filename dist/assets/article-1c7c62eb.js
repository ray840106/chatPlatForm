import{_ as te,u as oe,z as ae,c as se,r as y,f as w,g as le,o as l,a as r,m as F,j as d,n as E,d as v,b as t,F as L,i as O,w as I,h as f,k as ne,l as T,t as h,q as re,v as ie,E as ce,G as ue}from"./index-124aa391.js";import{M as de}from"./modal-ed5c79ec.js";import{S}from"./sweetalert2.all-75d83f30.js";import{r as fe}from"./PaperAirplaneIcon-2396592a.js";const g=R=>(ce("data-v-1c252429"),R=R(),ue(),R),he={class:E(["pt-24 pb-16 lg:pb-24 bg-white dark:bg-gray-900 antialiased md:pl-72"])},ge={class:"mb-4 lg:mb-6 not-format"},pe={class:"flex justify-between items-center mb-2"},me={class:"flex items-center"},_e={class:"inline-flex items-center mr-3 font-semibold text-sm text-gray-900 dark:text-white"},ve=["src"],ye={class:"items-center text-center cursor-pointer"},be={key:0,class:"bg-white rounded-md shadow-xl z-20"},xe=["onClick"],ke={class:"max-w-2xl mx-auto"},we={id:"default-carousel2",class:"relative","data-carousel":"static"},Ce=["onDblclick"],Ie=["src"],Te=["onClick"],Ae={class:"inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"},Le=g(()=>t("span",{class:"hidden"},"Previous",-1)),Ee=["onClick"],Re={class:"inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"},Ne=g(()=>t("span",{class:"hidden"},"Next",-1)),$e={class:"lead"},De=["onClick"],Oe={class:"text-xs text-gray-500 dark:text-gray-400"},je={pubdate:"",datetime:"2022-02-08",title:"February 8th, 2022"},Se={class:""},Pe=g(()=>t("div",{class:"flex justify-center items-center m-2"},[t("hr",{class:"border border-2 w-6"})],-1)),Me={class:"flex justify-center items-center mb-6"},Ue=g(()=>t("span",{class:"text-lg lg:text-2xl font-bold text-gray-900 dark:text-white"},"留言",-1)),ze={id:"inputReply",class:""},Fe=["innerHTML"],Be={class:"overflow-y-auto sm:h-40 md:h-80"},He={class:"flex justify-between items-center mb-2"},Ve={class:"flex items-center"},Ge={class:"inline-flex items-center mr-3 font-semibold text-sm text-gray-900 dark:text-white"},qe=["src"],Ke={class:"text-sm text-gray-600 dark:text-gray-400"},Ye={pubdate:"",datetime:"2022-02-08",title:"February 8th, 2022"},Je=["onClick"],We={class:"flex items-center mt-4 space-x-4"},Xe=["onClick"],Qe={class:"max-w-2xl mx-auto mb-2"},Ze=g(()=>t("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Photo",-1)),et={id:"default-carousel",class:"relative","data-carousel":"static"},tt={key:0,class:"overflow-hidden relative h-96 rounded-lg xl:h-80 2xl:h-96"},ot=["onClick"],at={class:"block absolute top-1/2 left-1/2 w-full -translate-x-1/2 -translate-y-1/2"},st=["src"],lt={key:1,class:"flex items-center justify-center w-full"},nt={class:"flex flex-col items-center justify-center w-full h-36 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},rt={class:"flex flex-col items-center justify-center pt-5 pb-6"},it=g(()=>t("p",{class:"mb-2 text-sm text-gray-500 dark:text-gray-400"},[t("span",{class:"font-semibold"},"Click to upload"),T(" or drag and drop")],-1)),ct=g(()=>t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"SVG, PNG, JPG or GIF (MAX. 800x400px)",-1)),ut={class:"inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"},dt=g(()=>t("span",{class:"hidden"},"Previous",-1)),ft={class:"inline-flex justify-center items-center w-8 h-8 rounded-full sm:w-10 sm:h-10 bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"},ht=g(()=>t("span",{class:"hidden"},"Next",-1)),gt={class:"mb-6"},pt=g(()=>t("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Content",-1)),mt={__name:"article",setup(R){const B=oe(),j=ae(),p=se(()=>B.state.loginInfo),m=y([]),A=y(!1),N=y(!1),C=y([]),b=y([]),x=y({}),_=y({}),k=y(0),P=j.query.token||null;G();async function M(a){Array.prototype.forEach.call(a.target.files,function(o,s){o.type.indexOf("image/"===0)&&H(URL.createObjectURL(o),1400,e=>{m.value.push({IMG_SRC:e,ORD:s})})})}function H(a,o,s){var e=new Image,i=.6;e.src=a;var n,c;e.onload=function(){n=this.width,c=this.height;var u=document.createElement("canvas"),z=u.getContext("2d");Math.max(n,c)>o?n>c?(u.width=o,u.height=o*c/n):(u.height=o,u.width=o*n/c):(u.width=n,u.height=c,i=.6),z.clearRect(0,0,u.width,u.height),z.drawImage(this,0,0,u.width,u.height);var ee=u.toDataURL("image/jpeg",i);s(ee)}}function V(){w({method:"post",url:"API/article",params:{method:"insArticle",loginInfo:p.value},data:{article:x.value,imgUrls:m.value}}).then(function(a){b.value=a.data.get_article,N.value=!1,S.fire(a.data.done_TF?"Success to save":"Fail to save","",a.data.done_TF?"success":"error")})}function G(){console.log(j.path),w({method:"post",url:"API/article",params:{method:"getArticles",loginInfo:p.value},data:{friend:P,path:j.path}}).then(function(a){b.value=a.data.get_article})}function $(a){a.LIKE_COUNT+=a.haveLike?-1:1,a.haveLike=!a.haveLike,w({method:"post",url:"API/article",params:{method:"likeArticle",loginInfo:p.value},data:{item:a}}).then(function(o){C.value=o.data.article_reply,b.value.forEach(function(s,e,i){s.ARTICLE_ID==o.data.get_article.ARTICLE_ID&&(i[e]=o.data.get_article)})})}function q(a){m.value.length-1==1?k.value=0:a==m.value.length-1&&k.value--,m.value.splice(a,1)}function D(a){w({method:"post",url:"API/article",params:{method:"geyReplyArticle",loginInfo:p.value},data:{replyItem:a}}).then(function(o){C.value=o.data.get_article_reply,_.value=a,A.value=!0,b.value.forEach(function(s,e,i){s.ARTICLE_ID==o.data.get_article.ARTICLE_ID&&(i[e]=o.data.get_article)})})}function K(a){w({method:"post",url:"API/article",params:{method:"geyBackReplyArticle",loginInfo:p.value},data:{replyItem:a}}).then(function(o){C.value=o.data.get_article_reply,_.value=a,A.value=!0})}function Y(a,o){let s="",e="",i=x.value[o],n=i.replace(/[^\u4e00-\u9fa5]+/,"");n&&(s=n.length*2);let c=i.match(/[^\u4e00-\u9fa5]+/);c&&(e=c[0].length),s+e>a&&(x.value[o]=x.value[o].slice(0,-1),S.fire("Character limit is "+a,"","error"))}function J(a){_.value.replyText=a.target.innerHTML}function W(){window.addEventListener("paste",X)}function X(a){a.preventDefault();const o=(a.clipboardData||window.clipboardData).getData("text/plain");var s=document.createElement("span");s.innerHTML=o,window.getSelection().getRangeAt(0).insertNode(s)}function Q(a){a.keyCode===13&&!a.shiftKey&&(_.value.replyText=a.target.innerHTML,a.preventDefault(),U())}function U(){w({method:"post",url:"API/article",params:{method:"replyArticle",loginInfo:p.value},data:{replyItem:_.value}}).then(function(a){C.value=a.data.get_article_reply,_.value.replyText="",b.value.forEach(function(o,s,e){o.ARTICLE_ID==a.data.get_article.ARTICLE_ID&&(e[s]=a.data.get_article)})})}async function Z(a){(await S.fire({icon:"question",title:"Delete article?",showDenyButton:!0,confirmButtonText:"OK",denyButtonText:"CANCEL"})).isConfirmed&&w({method:"post",url:"API/article",params:{method:"delArticle",loginInfo:p.value},data:{item:a}}).then(function(s){b.value=s.data.get_article})}return(a,o)=>{const s=le("font-awesome-icon");return l(),r(L,null,[F(P)===""?(l(),d(s,{key:0,icon:"fa-solid fa-circle-plus",class:E([p.value.mobile?"h-12 w-12 ml-3 mb-3":"h-24 w-24 fixed  left-72 bottom-0","cursor-pointer"]),onClick:o[0]||(o[0]=e=>N.value=!0)},null,8,["class"])):v("",!0),t("main",he,[t("div",{class:"space-y-8 px-4 mx-auto max-w-screen-xl",onClick:o[1]||(o[1]=e=>{A.value=!1,_.value.replyText=""})},[(l(!0),r(L,null,O(b.value,(e,i)=>(l(),r("article",{class:"mx-auto w-full max-w-2xl format format-sm sm:format-base lg:format-lg format-blue dark:format-invert",key:i},[t("header",ge,[t("footer",pe,[t("div",me,[t("p",_e,[e.headshot!=""?(l(),r("img",{key:0,class:"mr-2 w-6 h-6 rounded-full",src:e.headshot},null,8,ve)):(l(),d(s,{key:1,icon:"w-8 h-8 fa-solid fa-user inline-block"})),T(" "+h(e.AUTHOR),1)])]),t("div",ye,[f(s,{icon:"fa-solid fa-ellipsis",onClick:I(n=>e.dropdownOpen=!e.dropdownOpen,["stop"])},null,8,["onClick"]),e.dropdownOpen&&e.AUTHOR==p.value.EMAIL?(l(),r("div",be,[t("div",{class:"px-4 py-2 text-sm capitalize text-gray-700 hover:bg-blue-500 hover:text-white",onClick:n=>{Z(e)}},[f(s,{icon:"fa-solid fa-trash",class:"text-red-500 w-6 h-6"})],8,xe)])):v("",!0)])]),t("div",ke,[t("div",we,[e.article_img.length?(l(),r("div",{key:0,class:"overflow-hidden relative rounded-lg cursor-pointer",onDblclick:n=>$(e)},[(l(!0),r(L,null,O(e.article_img,(n,c)=>(l(),r("div",{class:E([e.sn==c?"":"hidden"," duration-700 ease-in-out w-96"]),"data-carousel-item":"",key:c},[t("img",{src:n.IMG_SRC,class:""},null,8,Ie)],2))),128))],40,Ce)):v("",!0),e.sn>0?(l(),r("button",{key:1,type:"button",class:"flex absolute top-0 left-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none","data-carousel-prev":"",onClick:n=>e.sn--},[t("span",Ae,[f(s,{icon:"fa-solid fa-angle-left",class:"w-5 h-5"}),Le])],8,Te)):v("",!0),e.sn<e.article_img.length-1?(l(),r("button",{key:2,type:"button",class:"flex absolute top-0 right-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none","data-carousel-next":"",onClick:n=>e.sn++},[t("span",Re,[f(s,{icon:"fa-solid fa-angle-right",class:"w-5 h-5"}),Ne])],8,Ee)):v("",!0)])])]),t("div",null,[T(h(e.LIKE_COUNT)+" ",1),e.haveLike?(l(),d(s,{key:0,icon:"fa-solid fa-heart",class:"cursor-pointer",onClick:n=>{$(e)}},null,8,["onClick"])):(l(),d(s,{key:1,icon:"fa-regular fa-heart",class:"cursor-pointer",onClick:n=>$(e)},null,8,["onClick"])),T(" "+h(e.REPLY_COUNT)+" ",1),e.haveReply?(l(),d(s,{key:2,icon:"fa-solid fa-message",class:"cursor-pointer",onClick:I(n=>{D(e)},["stop"])},null,8,["onClick"])):(l(),d(s,{key:3,icon:"fa-regular fa-message",class:"cursor-pointer",onClick:I(n=>{D(e)},["stop"])},null,8,["onClick"]))]),t("p",$e,h(e.CONTENT),1),e.REPLY_COUNT>0?(l(),r("span",{key:0,class:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer",onClick:I(n=>{D(e)},["stop"])},"查看全部留言"+h(e.REPLY_COUNT)+"則留言",9,De)):v("",!0),t("p",Oe,[t("time",je,h(e.INS_DATE.substring(0,10)),1)])]))),128))]),t("div",{class:E([A.value?"":"transition-transform translate-y-full","left-0 border border-2 rounded-t-lg z-40 fixed bottom-0 sm:h-64 md:h-1/2 w-screen bg-white border-r border-gray-200 sm:translate-x-0 dark:bg-gray-800 dark:border-gray-700"])},[t("section",Se,[t("div",{class:"cursor-pointer",onClick:o[3]||(o[3]=e=>A.value=!1)},[Pe,t("div",Me,[C.value.some(e=>e.LEVEL>1)?(l(),d(s,{key:0,icon:"fa-solid fa-angle-left",class:"w-10 h-10 cursor-pointer absolute left-0",onClick:o[2]||(o[2]=I(e=>K(_.value),["stop"]))})):v("",!0),Ue])]),t("form",ze,[t("div",{contenteditable:"true",innerHTML:_.value.replyText,class:"bg-gray-200 flex-grow border border-black rounded p-2 focus:outline-none focus:ring focus:border-blue-400 inline-block w-11/12",onFocus:W,onBlur:J,onKeydown:Q},null,40,Fe),f(F(fe),{class:"w-6 h-6 cursor-pointer align-middle inline-block",onClick:o[4]||(o[4]=e=>U())})]),t("div",Be,[(l(!0),r(L,null,O(C.value,(e,i)=>(l(),r("article",{class:"p-6 mb-6 text-base bg-white rounded-lg dark:bg-gray-900",key:i},[t("footer",He,[t("div",Ve,[t("p",Ge,[e.headshot!=""?(l(),r("img",{key:0,class:"mr-2 w-6 h-6 rounded-full",src:e.headshot},null,8,qe)):(l(),d(s,{key:1,icon:"w-8 h-8 fa-solid fa-user inline-block"})),T(" "+h(e.REPLY_AUTHOR),1)]),t("p",Ke,[t("time",Ye,h(e.INS_DATE.substring(0,10)),1)])]),t("div",{class:"items-center text-center",onClick:n=>{$(e)}},[e.haveLike?(l(),d(s,{key:0,icon:"fa-solid fa-heart"})):(l(),d(s,{key:1,icon:"fa-regular fa-heart"}))],8,Je)]),t("p",null,h(e.CONTENT),1),t("div",We,[t("button",{type:"button",class:"flex items-center font-medium text-sm text-gray-500 hover:underline dark:text-gray-400",onClick:I(n=>{D(e)},["stop"])},[e.haveReply?(l(),d(s,{key:0,icon:"fa-solid fa-message"})):(l(),d(s,{key:1,icon:"fa-regular fa-message"})),T(" Reply ")],8,Xe),t("span",null,h(e.REPLY_COUNT),1)])]))),128))])])],2)]),f(de,{title:"Add Article",onConfirm:V,openShow:N.value,onClose:o[9]||(o[9]=e=>{N.value=!1,m.value=[],x.value={}})},{body:ne(()=>[t("form",null,[t("div",Qe,[Ze,t("div",et,[m.value.length?(l(),r("div",tt,[(l(!0),r(L,null,O(m.value,(e,i)=>(l(),r("div",{class:E([k.value==i?"":"hidden"," duration-700 ease-in-out"]),"data-carousel-item":"",key:i},[t("div",null,[t("button",{class:"flex absolute float-right z-50",onClick:n=>q(i)},[f(s,{icon:"fa-solid fa-trash",class:"text-red-500 w-6 h-6"})],8,ot),t("label",at,[t("img",{src:e.IMG_SRC},null,8,st),t("input",{id:"dropzone-file-modal2",type:"file",multiple:"",onChange:M,accept:"image/*",class:"hidden"},null,32)])])],2))),128))])):(l(),r("div",lt,[t("label",nt,[t("div",rt,[f(s,{class:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400",icon:"fa-solid fa-cloud-arrow-up"}),it,ct]),t("input",{id:"dropzone-file-modal",type:"file",multiple:"",onChange:M,accept:"image/*",class:"hidden"},null,32)])])),k.value>0?(l(),r("button",{key:2,type:"button",class:"flex absolute top-0 left-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none","data-carousel-prev":"",onClick:o[5]||(o[5]=e=>k.value--)},[t("span",ut,[f(s,{icon:"fa-solid fa-angle-left",class:"w-5 h-5"}),dt])])):v("",!0),k.value<m.value.length-1?(l(),r("button",{key:3,type:"button",class:"flex absolute top-0 right-0 z-30 justify-center items-center px-4 h-full cursor-pointer group focus:outline-none","data-carousel-next":"",onClick:o[6]||(o[6]=e=>k.value++)},[t("span",ft,[f(s,{icon:"fa-solid fa-angle-right",class:"w-5 h-5"}),ht])])):v("",!0)])]),t("div",gt,[pt,re(t("textarea",{"onUpdate:modelValue":o[7]||(o[7]=e=>x.value.CONTENT=e),type:"text",id:"name-modal",rows:"10",onInput:o[8]||(o[8]=e=>Y(2e3,"CONTENT")),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,544),[[ie,x.value.CONTENT]])])])]),_:1},8,["openShow"])],64)}}},xt=te(mt,[["__scopeId","data-v-1c252429"]]);export{xt as default};
