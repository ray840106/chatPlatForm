import{c as q,s as k}from"./sendWS-539018fa.js";import{o as a,a as l,b as e,u as z,z as B,c as S,r as h,A as Y,B as U,f as m,g as j,h as d,l as V,t as x,m as E,F as I,i as N,n as u,j as v,d as M}from"./index-875e2a01.js";function K(D,_){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})])}const p="/assets/smile-2c7deeca.png",T="/assets/best_dog_hey-91b1c712.png",G=["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","🥳","😏","😒","😞","😔","😟","😕","🙁","☹️","😣","😖","😫","😩","🥺","😢","😭","‍💨","😤","😠","😡","🤬","🤯","😳","🥵","🥶","😱","😨","😰","😥","😓","🤗","🤔","🤭","🤫","🤥","😶","😐","😑","😬","🙄","😯","😦","😧","😮","😲","🥱","😴","🤤","😪","😵","‍💫","🤐","🥴","🤢","🤮","🤧","😷","🤒","🤕","🤑","🤠","😈","👿","👹","👺","🤡","💩","👻","💀","☠️","👽","👾","🤖","🎃","😺","😸","😹","😻","😼","😽","🙀","😿","😾"],J={class:"h-screen flex items-center w-screen md:ml-80"},Q={class:"lg:w-1/2 w-full rounded-lg overflow-hidden shadow-lg bg-white"},W={class:"bg-blue-600 py-4 px-6 text-white"},X={class:"text-lg font-semibold"},Z={class:"flex"},ee=["innerHTML"],te=["innerHTML"],oe=["src"],se=["href"],ne={class:"border-t px-6 py-4"},ae={class:"flex space-x-2"},le={class:"flex items-center"},ie={class:"flex items-center"},re=["innerHTML"],de=e("h5",{id:"drawer-navigation-label",class:"text-base font-semibold text-gray-500 uppercase dark:text-gray-400"},"Sticker",-1),ce=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),ue=e("span",{class:"sr-only"},"Close menu",-1),ge=[ce,ue],fe={class:"py-4 overflow-y-auto"},he={class:"inline-flex rounded-md shadow-sm mb-3",role:"group"},ve=e("img",{src:p,alt:"",class:"w-8 h-8"},null,-1),pe=[ve],_e=e("img",{src:T,alt:"",class:"w-8 h-8"},null,-1),be=[_e],ye={key:0,class:"grid grid-cols-6"},ke=["onClick"],xe={class:"text-2xl"},we={key:1,class:"grid grid-cols-2"},me=e("img",{src:T,alt:""},null,-1),Ee=[me],Ie=e("img",{src:p,alt:""},null,-1),Me=[Ie],Te={key:2,class:"grid grid-cols-2"},Ce={class:"relative opacity-50"},Le=e("img",{src:T,alt:""},null,-1),Se=[Le],Ne={class:"relative opacity-50"},De=e("img",{src:p,alt:""},null,-1),Ae=[De],$e={class:"relative opacity-50"},Fe=e("img",{src:p,alt:""},null,-1),He=[Fe],Re={class:"relative opacity-50"},Oe=e("img",{src:p,alt:""},null,-1),Pe=[Oe],Ue={__name:"chatPlatForm",setup(D){const _=z(),i=B(),r=S(()=>_.state.loginInfo),A=S(()=>_.state.messages),c=h(""),b=h(""),C=h(null),g=h(1),y=h(!1);q(),Y(async()=>{await U();const s=C.value;s.scrollTo({top:s.scrollHeight}),await k({roomData:i.query.token})}),i.query.token&&($(),k({roomData:i.query.token}));function $(){m({method:"post",url:"API/messages",params:{method:"getMessage",loginInfo:r.value},data:{item:{token:i.query.token}}}).then(function(s){_.dispatch("a_updMessages",s.data.get_messages)})}function w(s){let o=s==2?b.value:c.value;!c.value&&!b.value||m({method:"post",url:"API/messages",params:{method:"insMessage",loginInfo:r.value},data:{item:{token:i.query.token,text:o,textType:s}}}).then(function(n){let t=n.data.get_messages[n.data.get_messages.length-1];t.token=i.query.token,t.ROOMID=i.query.ROOMID,s!=2?c.value="":b.value="",k({updData:t})})}function F(s){c.value=s.target.innerHTML}function H(){window.addEventListener("paste",R)}function R(s){s.preventDefault();const o=(s.clipboardData||window.clipboardData).getData("text/plain");var n=document.createElement("span");n.innerHTML=o,window.getSelection().getRangeAt(0).insertNode(n)}function L(s){b.value+=`<img src=${s} class='h-36 w-36 inline-block'/>`,w(2)}function O(s){s.keyCode===13&&!s.shiftKey&&(c.value=s.target.innerHTML,s.preventDefault(),w(1))}async function P(s){const o=s.target.files.item(0),n=new FormData;n.append("file",o),await m({method:"post",url:"API/file",params:{method:"uploadMessage",loginInfo:r.value,token:i.query.token},data:n}).then(function(t){let f=t.data.get_messages[t.data.get_messages.length-1];f.token=i.query.token,f.ROOMID=i.query.ROOMID,c.value="",k({updData:f})})}function qe(){}return(s,o)=>{const n=j("font-awesome-icon");return a(),l(I,null,[e("div",J,[e("div",Q,[e("div",W,[e("h2",X,[d(n,{class:"w-8 h-8 mr-3 flex-none",icon:"fa-solid fa-circle-user"}),V(" "+x(E(i).query.FRIEND_EMAIL),1)])]),e("div",{ref_key:"messageBody",ref:C,class:"py-4 px-6 space-y-4 h-96 overflow-auto"},[(a(!0),l(I,null,N(A.value,t=>(a(),l("div",{class:"mb-3",key:t.id},[e("div",{class:u(["grid",t.INS_USER==r.value.EMAIL?"justify-items-end":"justify-items-start"])},[e("div",Z,[t.INS_USER!=r.value.EMAIL?(a(),v(n,{key:0,class:"w-8 h-8 mr-3 flex-none",icon:"fa-solid fa-circle-user"})):M("",!0),e("div",null,[t.TYPE==1?(a(),l("div",{key:0,class:u(["text-base px-4 py-3 rounded-tl-2xl rounded-tr-2xl",t.INS_USER==r.value.EMAIL?"bg-cyan-400 rounded-bl-2xl":"bg-slate-300 rounded-br-2xl"]),innerHTML:t.CONTENT},null,10,ee)):t.TYPE==2?(a(),l("div",{key:1,innerHTML:t.CONTENT},null,8,te)):t.TYPE==3?(a(),l("div",{key:2,class:u(["text-base px-4 py-3 rounded-tl-2xl rounded-tr-2xl",t.INS_USER==r.value.EMAIL?"bg-cyan-400 rounded-bl-2xl":"bg-slate-300 rounded-br-2xl"])},[e("img",{src:t.CONTENT,alt:"",class:"h-20 w-20"},null,8,oe)],2)):t.TYPE==4?(a(),l("div",{key:3,class:u(["w-44 text-base px-4 py-3 rounded-tl-2xl rounded-tr-2xl",t.INS_USER==r.value.EMAIL?"bg-cyan-400 rounded-bl-2xl":"bg-slate-300 rounded-br-2xl"])},[e("a",{href:t.CONTENT,download:"",target:"_blank",class:"grid grid-cols-2"},[e("div",null,[t.FILE_TYPE.includes("pdf")?(a(),v(n,{key:0,icon:"fa-solid fa-file-pdf",class:"h-12 w-12"})):t.FILE_TYPE.includes("doc")?(a(),v(n,{key:1,icon:"fa-solid fa-file-word",class:"h-12 w-12"})):t.FILE_TYPE.includes("sheet")?(a(),v(n,{key:2,icon:"fa-solid fa-file-excel",class:"h-12 w-12"})):t.FILE_TYPE.includes("zip")?(a(),v(n,{key:3,icon:"fa-regular fa-file-zipper",class:"h-12 w-12"})):M("",!0)]),e("div",null,[e("span",null,x(t.FILE_NAME),1)])],8,se)],2)):M("",!0),e("div",{class:u(["text-xs text-slate-400",t.INS_USER==r.value.EMAIL?"float-right":"float-left"])},x(`${new Date(t.INS_DATE).getHours()}:${new Date(t.INS_DATE).getMinutes()}`),3)])])],2)]))),128))],512),e("div",ne,[e("div",ae,[e("div",le,[e("label",null,[d(n,{icon:"fa-solid fa-paperclip",class:"h-6 w-6 cursor-pointer"}),e("input",{id:"dropzone-file",type:"file",class:"hidden",onChange:P},null,32)])]),e("div",ie,[d(n,{icon:"fa-solid fa-face-smile",class:"h-6 w-6 cursor-pointer",onClick:o[0]||(o[0]=t=>y.value=!y.value)})]),e("div",{contenteditable:"true",innerHTML:c.value,class:"flex-grow border rounded p-2 focus:outline-none focus:ring focus:border-blue-400",onFocus:H,onBlur:F,onKeydown:O},null,40,re),d(E(K),{class:"w-6 h-6 cursor-pointer align-middle mt-2",onClick:o[1]||(o[1]=t=>w(1))})])])])]),e("div",{id:"drawer-navigation",class:u([y.value?"-translate-x-full":""," fixed top-16 -right-64 z-40 w-64 h-screen p-4 overflow-y-auto transition-transform bg-white dark:bg-gray-800"]),tabindex:"-1","aria-labelledby":"drawer-navigation-label"},[de,e("button",{onClick:o[2]||(o[2]=t=>y.value=!1),type:"button","data-drawer-hide":"drawer-navigation","aria-controls":"drawer-navigation",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 absolute top-2.5 right-2.5 inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white"},ge),e("div",fe,[e("div",he,[e("button",{type:"button",onClick:o[3]||(o[3]=t=>g.value=1),class:"px-2 py-1 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-l-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},pe),e("button",{type:"button",onClick:o[4]||(o[4]=t=>g.value=2),class:"px-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},be),e("button",{type:"button",onClick:o[5]||(o[5]=t=>g.value=3),class:"px-3 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-r-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[d(n,{icon:"fa-solid fa-store",alt:"",class:"w-6 h-6 text-sky-600"})])]),g.value==1?(a(),l("div",ye,[(a(!0),l(I,null,N(E(G),(t,f)=>(a(),l("div",{key:f,onClick:ze=>c.value+=t,class:"cursor-pointer"},[e("span",xe,x(t),1)],8,ke))),128))])):g.value==2?(a(),l("div",we,[e("div",null,[e("button",{onClick:o[6]||(o[6]=t=>L("/public/sticker/best_dog_hey.png"))},Ee)]),e("div",null,[e("button",{onClick:o[7]||(o[7]=t=>L("/public/emoji/smile.png"))},Me)])])):(a(),l("div",Te,[e("div",Ce,[e("button",{onClick:o[8]||(o[8]=t=>void 0)},Se),d(n,{icon:"fa-solid fa-lock",class:"h-3 w-3 absolute left-24 bottom-4 cursor-pointer"})]),e("div",Ne,[e("button",{onClick:o[9]||(o[9]=t=>void 0),class:"opacity-50"},Ae),d(n,{icon:"fa-solid fa-lock",class:"h-3 w-3 absolute left-24 bottom-4 cursor-pointer"})]),e("div",$e,[e("button",{onClick:o[10]||(o[10]=t=>void 0),class:"opacity-50"},He),d(n,{icon:"fa-solid fa-lock",class:"h-3 w-3 absolute left-24 bottom-4 cursor-pointer"})]),e("div",Re,[e("button",{onClick:o[11]||(o[11]=t=>void 0),class:"opacity-50"},Pe),d(n,{icon:"fa-solid fa-lock",class:"h-3 w-3 absolute left-24 bottom-4 cursor-pointer"})])]))])],2)],64)}}};export{Ue as default};
