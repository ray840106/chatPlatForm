import{u as C,r as f,c as k,o as r,a as s,b as e,d as u,n as N,e as j,f as m,g as z,h as i,t as g,F as _,i as A,j as S,w as B,k as O,l as U,m as V,R as q}from"./index-875e2a01.js";import{D as G}from"./dialog-67f4689d.js";import{c as H}from"./sendWS-539018fa.js";import"./_plugin-vue_export-helper-c27b6911.js";const J="/assets/chatIcon-7602e55a.png",K={class:"bg-white dark:bg-gray-900 fixed w-full z-20 top-0 left-0 border-b border-gray-200 dark:border-gray-600 z-50"},Q={class:"max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4"},W=e("a",{href:"",class:"flex items-center"},[e("img",{src:J,class:"h-8 mr-3",alt:"chat Logo"}),e("span",{class:"self-center text-2xl font-semibold whitespace-nowrap dark:text-white"},"Chat")],-1),X={class:"flex md:order-2"},Y=e("a",{href:"/#/chatPlatForm",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center mr-3 md:mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},"Get started",-1),Z={key:0,href:"/API/logout",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center mr-3 md:mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 ml-2"},ee=e("span",{class:"sr-only"},"Open main menu",-1),te=e("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M1 1h15M1 7h15M1 13h15"})],-1),oe=[ee,te],re={class:"flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700"},ae=e("li",null,[e("a",{href:"/#/about",class:"block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"},"About")],-1),se=e("li",null,[e("a",{href:"/#/personal",class:"block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"},"Personal")],-1),ne={key:0},le=e("a",{href:"/API/logout",class:"block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"},"Logout",-1),de=[le],ie={__name:"navbar",setup(F){const l=C(),d=f(!1),n=k(()=>l.state.loginInfo);return(b,v)=>(r(),s("nav",K,[e("div",Q,[W,e("div",X,[Y,!n.value.mobile&&n.value.authTF?(r(),s("a",Z,"Logout")):u("",!0),e("button",{"data-collapse-toggle":"navbar-sticky",type:"button",onClick:v[0]||(v[0]=h=>d.value=!d.value),class:"inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600","aria-controls":"navbar-sticky","aria-expanded":"false"},oe)]),e("div",{class:N(["items-center justify-between w-full md:flex md:w-auto md:order-1",d.value?"":"hidden"]),id:"navbar-sticky"},[e("ul",re,[ae,se,n.value.mobile&&n.value.authTF?(r(),s("li",ne,de)):u("",!0)])],2)])]))}},ue={id:"logo-sidebar",class:"fixed top-0 left-0 z-40 w-64 h-screen pt-20 transition-transform -translate-x-full bg-white border-r border-gray-200 sm:translate-x-0 dark:bg-gray-800 dark:border-gray-700","aria-label":"Sidebar"},ce={class:"h-full px-3 pb-4 overflow-y-auto bg-white dark:bg-gray-800"},ge={class:"inline-flex rounded-md shadow-sm mb-3",role:"group"},he=e("span",{class:"top-0 left-4 absolute inline-flex items-center justify-center w-3 h-3 p-3 ml-3 text-sm font-medium text-blue-800 bg-blue-100 rounded-full dark:bg-blue-900 dark:text-blue-300"},"3",-1),fe={type:"button",href:"/#/addFriend",class:"px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-r-md hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},me=e("span",{class:"top-0 left-4 absolute inline-flex items-center justify-center w-3 h-3 p-3 ml-3 text-sm font-medium text-blue-800 bg-blue-100 rounded-full dark:bg-blue-900 dark:text-blue-300"},"3",-1),be={key:0},pe=e("hr",null,null,-1),ke={class:"space-y-2 font-medium"},ve=["onClick"],_e={class:"flex-1 ml-3 whitespace-nowrap"},ye=e("hr",null,null,-1),xe={class:"space-y-2 font-medium"},we=["onClick"],Ie={class:"flex-1 ml-3 whitespace-nowrap"},$e={key:1,class:"space-y-2 font-medium"},Ae=["onClick"],Ce={class:"flex-1 ml-3 whitespace-nowrap"},Fe={key:0,class:"inline-flex items-center justify-center w-4 h-4 ml-2 text-xs font-semibold text-blue-800 bg-blue-200 rounded-full"},Te=e("div",null,[e("button",{class:"bg-gray-200"},"test")],-1),Me={__name:"sidebar",setup(F){const l=C(),d=j(),n=k(()=>l.state.loginInfo),b=k(()=>l.state.friends),v=k(()=>l.state.rooms),h=f(1),y=f(!0),x=f(!0),w=f(!1),I=f({});H(),T();function E(){m({method:"post",url:"API/friends",params:{method:"getFriends",loginInfo:n.value}}).then(function(t){l.dispatch("a_friends",t.data.get_friends),h.value=0})}function T(){m({method:"post",url:"API/rooms",params:{method:"getRooms",loginInfo:n.value}}).then(function(t){l.dispatch("a_rooms",t.data.get_rooms),h.value=1})}function M(t){m({method:"post",url:"API/friends",params:{method:"getFriend",loginInfo:n.value},data:{item:t}}).then(function(a){l.dispatch("a_friend",a.data.get_friend),d.push({path:"/friends",query:{token:t.token}}),h.value=0})}function D(t){P(t),d.push({name:"chatPlatForm",query:{token:t.token,FRIEND_EMAIL:t.FRIEND_EMAIL,ROOMID:t.ROOMID}})}function P(t){m({method:"post",url:"API/messages",params:{method:"getMessage",loginInfo:n.value},data:{item:t}}).then(function(a){l.dispatch("a_updMessages",a.data.get_messages)})}function L(t){t.STATUS=1,m({method:"post",url:"API/friends",params:{method:"updFriend",loginInfo:n.value},data:{item:t}}).then(function(a){l.dispatch("a_friend",a.data.get_friend)})}function R(t){return b.value.filter(a=>a.STATUS==t).length}return(t,a)=>{const c=z("font-awesome-icon");return r(),s(_,null,[e("aside",ue,[e("div",ce,[e("div",ge,[e("button",{type:"button",onClick:E,class:"px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-l-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[i(c,{icon:"fa-solid fa-user-group"})]),e("button",{type:"button",onClick:T,class:"px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[i(c,{icon:"fa-solid fa-message"}),he]),e("a",fe,[i(c,{icon:"fa-solid fa-user-plus"}),me])]),h.value==0?(r(),s("div",be,[e("div",null,[e("label",{onClick:a[0]||(a[0]=o=>x.value=!x.value),class:"cursor-pointer select-none font-bold"},"好友請求("+g(R(-200))+")",1),pe,e("ul",ke,[(r(!0),s(_,null,A(b.value,(o,p)=>(r(),s("li",{key:p},[o.STATUS<=-200&&x.value?(r(),s("a",{key:0,onClick:$=>M(o),class:"flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group cursor-pointer select-none"},[i(c,{icon:"fa-solid fa-user"}),e("span",_e,g(o.FRIEND_EMAIL),1),o.STATUS==-200?(r(),S(c,{key:0,icon:"fa-solid fa-plus",onClick:B($=>{I.value=o,w.value=!0},["stop"])},null,8,["onClick"])):u("",!0)],8,ve)):u("",!0)]))),128))]),e("label",{onClick:a[1]||(a[1]=o=>y.value=!y.value),class:"cursor-pointer select-none font-bold"},"好友("+g(R(1))+")",1),ye,e("ul",xe,[(r(!0),s(_,null,A(b.value,(o,p)=>(r(),s("li",{key:p},[o.STATUS==1&&y.value?(r(),s("a",{key:0,onClick:$=>M(o),class:"flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group cursor-pointer select-none"},[i(c,{icon:"fa-solid fa-user"}),e("span",Ie,g(o.FRIEND_EMAIL),1)],8,we)):u("",!0)]))),128))])])])):u("",!0),h.value==1?(r(),s("ul",$e,[(r(!0),s(_,null,A(v.value,(o,p)=>(r(),s("li",{key:p},[e("a",{onClick:$=>D(o),class:"flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group cursor-pointer"},[i(c,{icon:"fa-solid fa-user"}),e("span",Ce,g(o.FRIEND_EMAIL),1),o.unread>0?(r(),s("span",Fe,g(o.unread),1)):u("",!0)],8,Ae)]))),128))])):u("",!0)]),Te]),i(G,{onConfirm:a[2]||(a[2]=o=>L(I.value)),openShow:w.value,onClose:a[3]||(a[3]=o=>w.value=!1)},{body:O(()=>[U(g("同意好友申請: "+I.value.FRIEND_EMAIL),1)]),_:1},8,["openShow"])],64)}}},Pe={__name:"layout",setup(F){const l=C(),d=k(()=>l.state.loginInfo);return setInterval(function(){m({method:"post",url:"API/auth",responseType:"json",params:{method:"tokenRefresh",loginInfo:d.value}}).then(function(n){console.log(n.data.loginToken),l.dispatch("update_loginToken",n.data)})},1e3*60*60*7),(n,b)=>(r(),s("div",null,[i(ie),d.value.authTF?(r(),S(Me,{key:0})):u("",!0),i(V(q))]))}};export{Pe as default};
